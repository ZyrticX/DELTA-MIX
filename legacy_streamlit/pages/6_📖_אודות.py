"""
עמוד אודות - הסבר על המערכת לצד הלקוח
"""

import streamlit as st
from utils import load_css, initialize_session_state

# טעינת CSS
load_css()

# אתחול session state
initialize_session_state()

# כותרת עמוד
st.title("📖 אודות המערכת")

# סקציה 1: מה המערכת עושה?
st.header("🎯 מה המערכת עושה?")

st.info("""
**Deltamix-CorrelationSystem** היא מערכת מתקדמת לניתוח קורלציות בין מניות ל-S&P 500, 
זיהוי הזדמנויות מסחר, ועדכון אוטומטי יומי.
""")

st.write("""
המערכת משכפלת **בדיוק** את הלוגיקה של גיליונות האקסל שלך, אבל:
- ✅ עובדת על **כל 500 מניות של S&P 500**
- ✅ מתחילה מ-**1.1.2012** (או כל תאריך אחר)
- ✅ **מתעדכנת אוטומטית** כל לילה
- ✅ כוללת **ממשק גרפי** נוח לשינוי פרמטרים
- ✅ **בלחיצת כפתור** - מקבל את כל ההתאמות
""")

st.markdown("---")

# סקציה 2: איך זה עובד?
st.header("🔬 איך המערכת עובדת?")

st.subheader("שלב 1: חישוב קורלציות גליליות (Rolling Correlations)")

st.write("""
עבור כל מניה וכל יום, המערכת מחשבת קורלציה בין:
- **15 מחירים אחרונים** של המניה (ברירת מחדל)
- **15 מחירים אחרונים** של S&P 500 (SPY)

אותו הדבר גם עבור **נפח המסחר** - קורלציה בין נפחי המסחר של המניה לנפחי המסחר של SPY.

*זה זהה לנוסחה באקסל: `=CORREL(OFFSET(...), OFFSET(...))`*
""")

st.subheader("שלב 2: שילוב קורלציות")

st.write("""
המערכת מציעה שלושה מצבי חישוב:
- **מצב 1:** קורלציית שער בלבד
- **מצב 2:** קורלציית מחזור בלבד
- **מצב 3 (מומלץ):** מכפלת קורלציות (שער × מחזור) - רק אם שניהם חיוביים

המצב השלישי הוא המומלץ כי הוא משלב את שני הגורמים החשובים: תנועת המחיר ונפח המסחר.
""")

st.subheader("שלב 3: חישוב יחס לממוצע נע")

st.write("""
עבור כל יום שבו הקורלציה עוברת את **סף המובהקות** (ברירת מחדל: 0.7), 
המערכת מחשבת:
""")

st.success("""
**יחס = ממוצע נע של 10 ימים / נפח המסחר הנוכחי**
""")

st.write("""
אם היחס גדול מ-**1.01** (ברירת מחדל), זה אומר שהנפח הנוכחי נמוך מהממוצע - 
**זו הזדמנות מסחר!**
""")

st.subheader("שלב 4: זיהוי הזדמנויות")

st.write("""
המערכת מזהה שני סוגי הזדמנויות:
- **UP:** ימים שבהם היחס > 1.01 (הזדמנות למכירה/יציאה)
- **DOWN:** ימים שבהם הקורלציה חיובית אבל היחס ≤ 1.01

המערכת סופרת כמה ימים מכל סוג היו לכל מניה לאורך כל התקופה ההיסטורית.
""")

st.markdown("---")

# סקציה 3: פרמטרים
st.header("⚙️ פרמטרי המערכת")

col1, col2 = st.columns(2)

with col1:
    st.subheader("פרמטרי חישוב")
    st.write("""
    - **אורך בלוק קורלציה:** 15 ימים (ברירת מחדל)
    - **סף מובהקות:** 0.7 (ערכים: 0-1)
    - **סוג חישוב:** 1/2/3 (ברירת מחדל: 3)
    - **אורך ממוצע נע:** 10 ימים
    - **סף מהותיות:** 1%
    """)

with col2:
    st.subheader("הגדרות נתונים")
    st.write("""
    - **תאריך התחלה:** 2012-01-01
    - **תאריך סיום:** היום
    - **מניית ייחוס:** SPY (S&P 500 ETF)
    - **מספר מניות:** 50-500
    """)

st.markdown("---")

# סקציה 4: תפעול
st.header("🚀 תפעול המערכת")

st.subheader("שלבי שימוש:")

st.write("""
1. **טעינת נתונים:** עבור לעמוד "📊 נתונים" וטען את הנתונים הנדרשים. 
   ההורדה הראשונה עשויה לקחת מספר דקות, אבל הנתונים נשמרים בקאש לשימוש מהיר בעתיד.

2. **הגדרת פרמטרים:** עבור לעמוד "🔬 ניתוח" והגדר את פרמטרי החישוב לפי הצרכים שלך.

3. **הרצת ניתוח:** לחץ על "▶️ הרץ ניתוח" והמערכת תריץ את כל החישובים.

4. **צפייה בתוצאות:** עבור לעמוד "📈 תוצאות" כדי לראות את כל התוצאות, 
   גרפים והזדמנויות מסחר.
""")

st.info("""
**💡 טיפים לשימוש אופטימלי:**
- התחל עם 50-100 מניות לבדיקה ראשונית
- נסה ערכים שונים ל-**סף מובהקות** (0.5-0.9) כדי למצוא את האופטימלי
- מינימום שנתיים נתונים לקורלציה טובה
- הרץ עדכון יומי **אחרי** סגירת השוק (16:00 ET)
- השתמש בקאש! זה מאיץ את החישובים פי 100
""")

st.markdown("---")

# סקציה 5: עדכון אוטומטי
st.header("🤖 עדכון אוטומטי יומי")

st.write("""
המערכת תומכת בעדכון אוטומטי יומי של הנתונים. ניתן להגדיר את זה דרך:
- **Windows:** Task Scheduler
- **Linux/Mac:** Cron

העדכון יריץ את הקובץ `daily_update.py` כל לילה ויעדכן את כל הנתונים אוטומטית.
""")

st.markdown("---")

# כותרת תחתונה
st.markdown("""
<div style='text-align: center; color: #0066CC; padding: 1rem; direction: rtl;'>
    נבנתה ע"י SmartMindsAI - Ilya & Evgeniy
</div>
""", unsafe_allow_html=True)

